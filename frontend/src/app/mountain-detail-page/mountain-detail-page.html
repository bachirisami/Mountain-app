<app-header></app-header>

<div class="flex items-center justify-center min-h-[calc(100vh-4rem)] bg-gradient-to-b from-blue-50 to-blue-100 p-6 relative">

  <div class="bg-white p-8 rounded-3xl shadow-xl w-full max-w-6xl transition-transform hover:-translate-y-1 relative">

    @if(errorMessage() != null) {
      <p class="text-red-600 font-semibold mb-6 animate-pulse">{{ errorMessage() }}</p>
    } @else {
      <h2 class="text-3xl font-bold text-gray-800 text-center mb-8">{{ mountain()?.name }}</h2>

      <div class="flex flex-col lg:flex-row gap-6">

        <!-- Left Side: Image + Info -->
        <div class="flex-1 flex flex-col items-center lg:items-start gap-6">
          <div class="w-full h-96 rounded-xl overflow-hidden shadow-inner">
            <img
              [src]="mountain()?.image_url || 'https://via.placeholder.com/400x400?text=No+Image'"
              alt="{{ mountain()?.name }}"
              class="w-full h-full object-cover rounded-xl"
            />
          </div>

          <p class="text-gray-700 text-lg">
            <strong>Height:</strong> {{ mountain()?.height }} m
          </p>
          <p class="text-gray-700 text-lg">
            <strong>Location:</strong> {{ mountain()?.location }}
          </p>

          @if(isLoggedIn()) {
            <div class="flex gap-4 mt-4">
              <button
                (click)="openDeleteModal()"
                class="bg-red-600 text-white px-5 py-3 rounded-lg font-medium hover:bg-red-700 transition shadow-sm"
              >
                Delete
              </button>

              <button
                (click)="openUpdateModal()"
                class="bg-yellow-500 text-white px-5 py-3 rounded-lg font-medium hover:bg-yellow-600 transition shadow-sm"
              >
                Update
              </button>
            </div>
          }
        </div>

        <!-- Right Side: Map -->
        <div class="flex-1 h-96 rounded-xl overflow-hidden shadow-inner">
          <img
            [src]="mountain()
              ? 'https://static-maps.yandex.ru/1.x/?ll=' + mountain()?.longitude + ',' + mountain()?.latitude + '&size=650,400&z=8&l=map&pt=' + mountain()?.longitude + ',' + mountain()?.latitude + ',pm2rdm'
              : 'https://via.placeholder.com/650x400?text=No+Map' "
            alt="Map of {{ mountain()?.name }}"
            class="w-full h-full object-cover rounded-xl"
          />
        </div>

      </div>
    }

  </div>

  @if(showUpdateModal()) {
    <app-update-modal
      [name]="mountain()?.name || ''"
      [height]="mountain()?.height || 0"
      [location]="mountain()?.location || ''"
      [imageUrl]="mountain()?.image_url || ''"
      [latitude]="mountain()?.latitude || 0"
      [longitude]="mountain()?.longitude || 0"
      (saveUpdate)="handleUpdate($event)"
      (closeModal)="closeUpdateModal()"
    />
  }

  @if(showDeleteModal()) {
    <app-delete-modal
      [mountainName]="mountain()?.name || ''"
      (confirmDelete)="confirmDelete()"
      (closeModal)="closeDeleteModal()"
    />
  }

</div>

<style>
  ::placeholder {
    opacity: 0.5;
  }
</style>
